<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Intégration continue | Travailler avec R</title>
  <meta name="description" content="Support du cours Travailler avec R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Intégration continue | Travailler avec R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Support du cours Travailler avec R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Intégration continue | Travailler avec R" />
  
  <meta name="twitter:description" content="Support du cours Travailler avec R." />
  

<meta name="author" content="Eric Marcon" />


<meta name="date" content="2020-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-package.html"/>
<link rel="next" href="chap-shiny.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7NVD1TWMCJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7NVD1TWMCJ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Travailler avec R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objectifs"><i class="fa fa-check"></i>Objectifs</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-logiciels.html"><a href="chap-logiciels.html"><i class="fa fa-check"></i><b>1</b> Logiciels</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap-logiciels.html"><a href="chap-logiciels.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation"><i class="fa fa-check"></i><b>1.1.1</b> Installation</a></li>
<li class="chapter" data-level="1.1.2" data-path="chap-logiciels.html"><a href="chap-logiciels.html#rtools"><i class="fa fa-check"></i><b>1.1.2</b> Rtools</a></li>
<li class="chapter" data-level="1.1.3" data-path="chap-logiciels.html"><a href="chap-logiciels.html#mise-à-jour"><i class="fa fa-check"></i><b>1.1.3</b> Mise à jour</a></li>
<li class="chapter" data-level="1.1.4" data-path="chap-logiciels.html"><a href="chap-logiciels.html#sec:librairies"><i class="fa fa-check"></i><b>1.1.4</b> Librairies</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chap-logiciels.html"><a href="chap-logiciels.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation-1"><i class="fa fa-check"></i><b>1.2.1</b> Installation</a></li>
<li class="chapter" data-level="1.2.2" data-path="chap-logiciels.html"><a href="chap-logiciels.html#dossier-de-travail"><i class="fa fa-check"></i><b>1.2.2</b> Dossier de travail</a></li>
<li class="chapter" data-level="1.2.3" data-path="chap-logiciels.html"><a href="chap-logiciels.html#sec:solution-dossiers"><i class="fa fa-check"></i><b>1.2.3</b> Solution retenue</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chap-logiciels.html"><a href="chap-logiciels.html#packages"><i class="fa fa-check"></i><b>1.3</b> Packages</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation-depuis-cran"><i class="fa fa-check"></i><b>1.3.1</b> Installation depuis CRAN</a></li>
<li class="chapter" data-level="1.3.2" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation-depuis-github"><i class="fa fa-check"></i><b>1.3.2</b> Installation depuis GitHub</a></li>
<li class="chapter" data-level="1.3.3" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation-depuis-bioconductor"><i class="fa fa-check"></i><b>1.3.3</b> Installation depuis Bioconductor</a></li>
<li class="chapter" data-level="1.3.4" data-path="chap-logiciels.html"><a href="chap-logiciels.html#solution-retenue"><i class="fa fa-check"></i><b>1.3.4</b> Solution retenue</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chap-logiciels.html"><a href="chap-logiciels.html#git"><i class="fa fa-check"></i><b>1.4</b> Git</a></li>
<li class="chapter" data-level="1.5" data-path="chap-logiciels.html"><a href="chap-logiciels.html#github"><i class="fa fa-check"></i><b>1.5</b> GitHub</a></li>
<li class="chapter" data-level="1.6" data-path="chap-logiciels.html"><a href="chap-logiciels.html#miktex"><i class="fa fa-check"></i><b>1.6</b> MiKTeX</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="chap-logiciels.html"><a href="chap-logiciels.html#installation-2"><i class="fa fa-check"></i><b>1.6.1</b> Installation</a></li>
<li class="chapter" data-level="1.6.2" data-path="chap-logiciels.html"><a href="chap-logiciels.html#mises-à-jour"><i class="fa fa-check"></i><b>1.6.2</b> Mises à jour</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="chap-logiciels.html"><a href="chap-logiciels.html#go"><i class="fa fa-check"></i><b>1.7</b> Go</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html"><i class="fa fa-check"></i><b>2</b> Utiliser R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#les-langages-de-r"><i class="fa fa-check"></i><b>2.1</b> Les langages de R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#base"><i class="fa fa-check"></i><b>2.1.1</b> Base</a></li>
<li class="chapter" data-level="2.1.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#sec:S3"><i class="fa fa-check"></i><b>2.1.2</b> S3</a></li>
<li class="chapter" data-level="2.1.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#s4"><i class="fa fa-check"></i><b>2.1.3</b> S4</a></li>
<li class="chapter" data-level="2.1.4" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#rc"><i class="fa fa-check"></i><b>2.1.4</b> RC</a></li>
<li class="chapter" data-level="2.1.5" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#s6"><i class="fa fa-check"></i><b>2.1.5</b> S6</a></li>
<li class="chapter" data-level="2.1.6" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#tidyverse"><i class="fa fa-check"></i><b>2.1.6</b> Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#sec:environnements"><i class="fa fa-check"></i><b>2.2</b> Environnements</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#organisation"><i class="fa fa-check"></i><b>2.2.1</b> Organisation</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#recherche"><i class="fa fa-check"></i><b>2.2.2</b> Recherche</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#espaces-de-nom-des-packages"><i class="fa fa-check"></i><b>2.2.3</b> Espaces de nom des packages</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#mesure-du-temps-dexécution"><i class="fa fa-check"></i><b>2.3</b> Mesure du temps d’exécution</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#system.time"><i class="fa fa-check"></i><b>2.3.1</b> system.time</a></li>
<li class="chapter" data-level="2.3.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#microbenchmark"><i class="fa fa-check"></i><b>2.3.2</b> microbenchmark</a></li>
<li class="chapter" data-level="2.3.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#profilage"><i class="fa fa-check"></i><b>2.3.3</b> Profilage</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#boucles"><i class="fa fa-check"></i><b>2.4</b> Boucles</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#fonctions-vectorielles"><i class="fa fa-check"></i><b>2.4.1</b> Fonctions vectorielles</a></li>
<li class="chapter" data-level="2.4.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#lapply"><i class="fa fa-check"></i><b>2.4.2</b> lapply</a></li>
<li class="chapter" data-level="2.4.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#boucles-for"><i class="fa fa-check"></i><b>2.4.3</b> Boucles for</a></li>
<li class="chapter" data-level="2.4.4" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#replicate"><i class="fa fa-check"></i><b>2.4.4</b> replicate</a></li>
<li class="chapter" data-level="2.4.5" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#vectorize"><i class="fa fa-check"></i><b>2.4.5</b> Vectorize</a></li>
<li class="chapter" data-level="2.4.6" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#statistiques-marginales"><i class="fa fa-check"></i><b>2.4.6</b> Statistiques marginales</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#sec:cpp"><i class="fa fa-check"></i><b>2.5</b> Code C++</a></li>
<li class="chapter" data-level="2.6" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#paralléliser-r"><i class="fa fa-check"></i><b>2.6</b> Paralléliser R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#mclapply-fork"><i class="fa fa-check"></i><b>2.6.1</b> mclapply (fork)</a></li>
<li class="chapter" data-level="2.6.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#parlapply-socket"><i class="fa fa-check"></i><b>2.6.2</b> parLapply (socket)</a></li>
<li class="chapter" data-level="2.6.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#foreach"><i class="fa fa-check"></i><b>2.6.3</b> foreach</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#sec:cas"><i class="fa fa-check"></i><b>2.7</b> Etude de cas</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#création-des-données"><i class="fa fa-check"></i><b>2.7.1</b> Création des données</a></li>
<li class="chapter" data-level="2.7.2" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#spatstat"><i class="fa fa-check"></i><b>2.7.2</b> Spatstat</a></li>
<li class="chapter" data-level="2.7.3" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#apply"><i class="fa fa-check"></i><b>2.7.3</b> apply</a></li>
<li class="chapter" data-level="2.7.4" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#boucle-for"><i class="fa fa-check"></i><b>2.7.4</b> boucle for</a></li>
<li class="chapter" data-level="2.7.5" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#boucle-foreach"><i class="fa fa-check"></i><b>2.7.5</b> boucle foreach</a></li>
<li class="chapter" data-level="2.7.6" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#rcpp"><i class="fa fa-check"></i><b>2.7.6</b> RCpp</a></li>
<li class="chapter" data-level="2.7.7" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#rcppparallel"><i class="fa fa-check"></i><b>2.7.7</b> RcppParallel</a></li>
<li class="chapter" data-level="2.7.8" data-path="chap-utiliseR.html"><a href="chap-utiliseR.html#conclusions-sur-loptimisation-de-la-vitesse-du-code"><i class="fa fa-check"></i><b>2.7.8</b> Conclusions sur l’optimisation de la vitesse du code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-git.html"><a href="chap-git.html"><i class="fa fa-check"></i><b>3</b> Git et GitHub</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap-git.html"><a href="chap-git.html#sec:principes-git"><i class="fa fa-check"></i><b>3.1</b> Principes</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chap-git.html"><a href="chap-git.html#sec:git-cds"><i class="fa fa-check"></i><b>3.1.1</b> Contrôle de source</a></li>
<li class="chapter" data-level="3.1.2" data-path="chap-git.html"><a href="chap-git.html#git-et-github"><i class="fa fa-check"></i><b>3.1.2</b> git et GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chap-git.html"><a href="chap-git.html#créer-un-nouveau-dépôt"><i class="fa fa-check"></i><b>3.2</b> Créer un nouveau dépôt</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chap-git.html"><a href="chap-git.html#a-partir-dun-projet-existant"><i class="fa fa-check"></i><b>3.2.1</b> A partir d’un projet existant</a></li>
<li class="chapter" data-level="3.2.2" data-path="chap-git.html"><a href="chap-git.html#prendre-en-compte-des-fichiers"><i class="fa fa-check"></i><b>3.2.2</b> Prendre en compte des fichiers</a></li>
<li class="chapter" data-level="3.2.3" data-path="chap-git.html"><a href="chap-git.html#valider-des-modifications"><i class="fa fa-check"></i><b>3.2.3</b> Valider des modifications</a></li>
<li class="chapter" data-level="3.2.4" data-path="chap-git.html"><a href="chap-git.html#créer-un-dépôt-vide-sur-github"><i class="fa fa-check"></i><b>3.2.4</b> Créer un dépôt vide sur GitHub</a></li>
<li class="chapter" data-level="3.2.5" data-path="chap-git.html"><a href="chap-git.html#lier-git-et-github"><i class="fa fa-check"></i><b>3.2.5</b> Lier git et GitHub</a></li>
<li class="chapter" data-level="3.2.6" data-path="chap-git.html"><a href="chap-git.html#pousser-les-premières-modifications"><i class="fa fa-check"></i><b>3.2.6</b> Pousser les premières modifications</a></li>
<li class="chapter" data-level="3.2.7" data-path="chap-git.html"><a href="chap-git.html#cloner-un-dépôt-de-github"><i class="fa fa-check"></i><b>3.2.7</b> Cloner un dépôt de GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chap-git.html"><a href="chap-git.html#usage-courant"><i class="fa fa-check"></i><b>3.3</b> Usage courant</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chap-git.html"><a href="chap-git.html#tirer-modifier-valider-pousser"><i class="fa fa-check"></i><b>3.3.1</b> Tirer, modifier, valider, pousser</a></li>
<li class="chapter" data-level="3.3.2" data-path="chap-git.html"><a href="chap-git.html#régler-les-conflits"><i class="fa fa-check"></i><b>3.3.2</b> Régler les conflits</a></li>
<li class="chapter" data-level="3.3.3" data-path="chap-git.html"><a href="chap-git.html#voir-les-différences"><i class="fa fa-check"></i><b>3.3.3</b> Voir les différences</a></li>
<li class="chapter" data-level="3.3.4" data-path="chap-git.html"><a href="chap-git.html#revenir-en-arrière"><i class="fa fa-check"></i><b>3.3.4</b> Revenir en arrière</a></li>
<li class="chapter" data-level="3.3.5" data-path="chap-git.html"><a href="chap-git.html#voir-lhistorique"><i class="fa fa-check"></i><b>3.3.5</b> Voir l’historique</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chap-git.html"><a href="chap-git.html#sec:branches"><i class="fa fa-check"></i><b>3.4</b> Branches</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chap-git.html"><a href="chap-git.html#créer-une-nouvelle-branche"><i class="fa fa-check"></i><b>3.4.1</b> Créer une nouvelle branche</a></li>
<li class="chapter" data-level="3.4.2" data-path="chap-git.html"><a href="chap-git.html#changer-de-branche"><i class="fa fa-check"></i><b>3.4.2</b> Changer de branche</a></li>
<li class="chapter" data-level="3.4.3" data-path="chap-git.html"><a href="chap-git.html#fusionner-avec-merge"><i class="fa fa-check"></i><b>3.4.3</b> Fusionner avec <code>merge</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="chap-git.html"><a href="chap-git.html#fusionner-avec-une-requête-de-tirage"><i class="fa fa-check"></i><b>3.4.4</b> Fusionner avec une requête de tirage</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chap-git.html"><a href="chap-git.html#usage-avancé"><i class="fa fa-check"></i><b>3.5</b> Usage avancé</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chap-git.html"><a href="chap-git.html#commandes-de-git"><i class="fa fa-check"></i><b>3.5.1</b> Commandes de git</a></li>
<li class="chapter" data-level="3.5.2" data-path="chap-git.html"><a href="chap-git.html#taille-dun-dépôt"><i class="fa fa-check"></i><b>3.5.2</b> Taille d’un dépôt</a></li>
<li class="chapter" data-level="3.5.3" data-path="chap-git.html"><a href="chap-git.html#supprimer-un-dossier"><i class="fa fa-check"></i><b>3.5.3</b> Supprimer un dossier</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chap-git.html"><a href="chap-git.html#sec:github-pages"><i class="fa fa-check"></i><b>3.6</b> Pages GitHub</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chap-git.html"><a href="chap-git.html#activation"><i class="fa fa-check"></i><b>3.6.1</b> Activation</a></li>
<li class="chapter" data-level="3.6.2" data-path="chap-git.html"><a href="chap-git.html#badges"><i class="fa fa-check"></i><b>3.6.2</b> Badges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-rediger.html"><a href="chap-rediger.html"><i class="fa fa-check"></i><b>4</b> Rédiger</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-rediger.html"><a href="chap-rediger.html#bloc-note-markdown-r-notebook"><i class="fa fa-check"></i><b>4.1</b> Bloc-note Markdown (R Notebook)</a></li>
<li class="chapter" data-level="4.2" data-path="chap-rediger.html"><a href="chap-rediger.html#modèles-r-markdown"><i class="fa fa-check"></i><b>4.2</b> Modèles R Markdown</a></li>
<li class="chapter" data-level="4.3" data-path="chap-rediger.html"><a href="chap-rediger.html#memo-article-bookdown"><i class="fa fa-check"></i><b>4.3</b> Memo, article : bookdown</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chap-rediger.html"><a href="chap-rediger.html#sec:memo"><i class="fa fa-check"></i><b>4.3.1</b> Modèle Memo EcoFoG</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap-rediger.html"><a href="chap-rediger.html#autres-modèles"><i class="fa fa-check"></i><b>4.3.2</b> Autres modèles</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap-rediger.html"><a href="chap-rediger.html#présentation-ecofog-bookdown"><i class="fa fa-check"></i><b>4.4</b> Présentation EcoFoG : bookdown</a></li>
<li class="chapter" data-level="4.5" data-path="chap-rediger.html"><a href="chap-rediger.html#ouvrage-ecofog-bookdown"><i class="fa fa-check"></i><b>4.5</b> Ouvrage EcoFoG : bookdown</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chap-rediger.html"><a href="chap-rediger.html#créer-1"><i class="fa fa-check"></i><b>4.5.1</b> Créer</a></li>
<li class="chapter" data-level="4.5.2" data-path="chap-rediger.html"><a href="chap-rediger.html#ecrire-1"><i class="fa fa-check"></i><b>4.5.2</b> Ecrire</a></li>
<li class="chapter" data-level="4.5.3" data-path="chap-rediger.html"><a href="chap-rediger.html#tricoter-1"><i class="fa fa-check"></i><b>4.5.3</b> Tricoter</a></li>
<li class="chapter" data-level="4.5.4" data-path="chap-rediger.html"><a href="chap-rediger.html#finitions"><i class="fa fa-check"></i><b>4.5.4</b> Finitions</a></li>
<li class="chapter" data-level="4.5.5" data-path="chap-rediger.html"><a href="chap-rediger.html#sec:rediger-ouvrage-ci"><i class="fa fa-check"></i><b>4.5.5</b> Intégration continue</a></li>
<li class="chapter" data-level="4.5.6" data-path="chap-rediger.html"><a href="chap-rediger.html#google-analytics"><i class="fa fa-check"></i><b>4.5.6</b> Google Analytics</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chap-rediger.html"><a href="chap-rediger.html#site-web-r-markdown"><i class="fa fa-check"></i><b>4.6</b> Site web R Markdown</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chap-rediger.html"><a href="chap-rediger.html#modèle"><i class="fa fa-check"></i><b>4.6.1</b> Modèle</a></li>
<li class="chapter" data-level="4.6.2" data-path="chap-rediger.html"><a href="chap-rediger.html#améliorations"><i class="fa fa-check"></i><b>4.6.2</b> Améliorations</a></li>
<li class="chapter" data-level="4.6.3" data-path="chap-rediger.html"><a href="chap-rediger.html#contôle-de-source"><i class="fa fa-check"></i><b>4.6.3</b> Contôle de source</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chap-rediger.html"><a href="chap-rediger.html#sec:blogdown"><i class="fa fa-check"></i><b>4.7</b> Site web personnel : blogdown</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="chap-rediger.html"><a href="chap-rediger.html#installation-des-outils"><i class="fa fa-check"></i><b>4.7.1</b> Installation des outils</a></li>
<li class="chapter" data-level="4.7.2" data-path="chap-rediger.html"><a href="chap-rediger.html#créer-2"><i class="fa fa-check"></i><b>4.7.2</b> Créer</a></li>
<li class="chapter" data-level="4.7.3" data-path="chap-rediger.html"><a href="chap-rediger.html#paramétrer"><i class="fa fa-check"></i><b>4.7.3</b> Paramétrer</a></li>
<li class="chapter" data-level="4.7.4" data-path="chap-rediger.html"><a href="chap-rediger.html#ecrire-2"><i class="fa fa-check"></i><b>4.7.4</b> Ecrire</a></li>
<li class="chapter" data-level="4.7.5" data-path="chap-rediger.html"><a href="chap-rediger.html#sec:rediger-web-ci"><i class="fa fa-check"></i><b>4.7.5</b> Intégration continue</a></li>
<li class="chapter" data-level="4.7.6" data-path="chap-rediger.html"><a href="chap-rediger.html#mises-à-jour-1"><i class="fa fa-check"></i><b>4.7.6</b> Mises à jour</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="chap-rediger.html"><a href="chap-rediger.html#exportation-de-figures"><i class="fa fa-check"></i><b>4.8</b> Exportation de figures</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="chap-rediger.html"><a href="chap-rediger.html#formats-vectoriels-et-raster"><i class="fa fa-check"></i><b>4.8.1</b> Formats vectoriels et raster</a></li>
<li class="chapter" data-level="4.8.2" data-path="chap-rediger.html"><a href="chap-rediger.html#fonctions"><i class="fa fa-check"></i><b>4.8.2</b> Fonctions</a></li>
<li class="chapter" data-level="4.8.3" data-path="chap-rediger.html"><a href="chap-rediger.html#package-ragg"><i class="fa fa-check"></i><b>4.8.3</b> Package ragg</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-package.html"><a href="chap-package.html"><i class="fa fa-check"></i><b>5</b> Package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-package.html"><a href="chap-package.html#premier-package"><i class="fa fa-check"></i><b>5.1</b> Premier package</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chap-package.html"><a href="chap-package.html#création"><i class="fa fa-check"></i><b>5.1.1</b> Création</a></li>
<li class="chapter" data-level="5.1.2" data-path="chap-package.html"><a href="chap-package.html#première-fonction"><i class="fa fa-check"></i><b>5.1.2</b> Première fonction</a></li>
<li class="chapter" data-level="5.1.3" data-path="chap-package.html"><a href="chap-package.html#sec:package-cds"><i class="fa fa-check"></i><b>5.1.3</b> Contrôle de source</a></li>
<li class="chapter" data-level="5.1.4" data-path="chap-package.html"><a href="chap-package.html#package.r"><i class="fa fa-check"></i><b>5.1.4</b> package.R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chap-package.html"><a href="chap-package.html#organisation-du-package"><i class="fa fa-check"></i><b>5.2</b> Organisation du package</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chap-package.html"><a href="chap-package.html#sec:package-description"><i class="fa fa-check"></i><b>5.2.1</b> Fichier DESCRIPTION</a></li>
<li class="chapter" data-level="5.2.2" data-path="chap-package.html"><a href="chap-package.html#fichier-news.md"><i class="fa fa-check"></i><b>5.2.2</b> Fichier NEWS.md</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chap-package.html"><a href="chap-package.html#vignette-et-pkgdown"><i class="fa fa-check"></i><b>5.3</b> Vignette et pkgdown</a></li>
<li class="chapter" data-level="5.4" data-path="chap-package.html"><a href="chap-package.html#code-spécifique-aux-packages"><i class="fa fa-check"></i><b>5.4</b> Code spécifique aux packages</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap-package.html"><a href="chap-package.html#importation-de-fonctions"><i class="fa fa-check"></i><b>5.4.1</b> Importation de fonctions</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap-package.html"><a href="chap-package.html#méthodes-s3"><i class="fa fa-check"></i><b>5.4.2</b> Méthodes S3</a></li>
<li class="chapter" data-level="5.4.3" data-path="chap-package.html"><a href="chap-package.html#en-pratique"><i class="fa fa-check"></i><b>5.4.3</b> En pratique</a></li>
<li class="chapter" data-level="5.4.4" data-path="chap-package.html"><a href="chap-package.html#code-c"><i class="fa fa-check"></i><b>5.4.4</b> Code C++</a></li>
<li class="chapter" data-level="5.4.5" data-path="chap-package.html"><a href="chap-package.html#package-bien-rangé"><i class="fa fa-check"></i><b>5.4.5</b> Package bien rangé</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chap-package.html"><a href="chap-package.html#bibliographie"><i class="fa fa-check"></i><b>5.5</b> Bibliographie</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chap-package.html"><a href="chap-package.html#préparation"><i class="fa fa-check"></i><b>5.5.1</b> Préparation</a></li>
<li class="chapter" data-level="5.5.2" data-path="chap-package.html"><a href="chap-package.html#citations"><i class="fa fa-check"></i><b>5.5.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap-package.html"><a href="chap-package.html#données"><i class="fa fa-check"></i><b>5.6</b> Données</a></li>
<li class="chapter" data-level="5.7" data-path="chap-package.html"><a href="chap-package.html#tests-unitaires"><i class="fa fa-check"></i><b>5.7</b> Tests unitaires</a></li>
<li class="chapter" data-level="5.8" data-path="chap-package.html"><a href="chap-package.html#fichier-.gitignore"><i class="fa fa-check"></i><b>5.8</b> Fichier .gitignore</a></li>
<li class="chapter" data-level="5.9" data-path="chap-package.html"><a href="chap-package.html#sec:package-ci5"><i class="fa fa-check"></i><b>5.9</b> Intégration continue</a></li>
<li class="chapter" data-level="5.10" data-path="chap-package.html"><a href="chap-package.html#cran"><i class="fa fa-check"></i><b>5.10</b> CRAN</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="chap-package.html"><a href="chap-package.html#test-du-package"><i class="fa fa-check"></i><b>5.10.1</b> Test du package</a></li>
<li class="chapter" data-level="5.10.2" data-path="chap-package.html"><a href="chap-package.html#soumission"><i class="fa fa-check"></i><b>5.10.2</b> Soumission</a></li>
<li class="chapter" data-level="5.10.3" data-path="chap-package.html"><a href="chap-package.html#maintenance"><i class="fa fa-check"></i><b>5.10.3</b> Maintenance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-ci.html"><a href="chap-ci.html"><i class="fa fa-check"></i><b>6</b> Intégration continue</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap-ci.html"><a href="chap-ci.html#outils"><i class="fa fa-check"></i><b>6.1</b> Outils</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chap-ci.html"><a href="chap-ci.html#travis"><i class="fa fa-check"></i><b>6.1.1</b> Travis</a></li>
<li class="chapter" data-level="6.1.2" data-path="chap-ci.html"><a href="chap-ci.html#codecov"><i class="fa fa-check"></i><b>6.1.2</b> Codecov</a></li>
<li class="chapter" data-level="6.1.3" data-path="chap-ci.html"><a href="chap-ci.html#github-pages"><i class="fa fa-check"></i><b>6.1.3</b> GitHub Pages</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chap-ci.html"><a href="chap-ci.html#intégration-continue-dun-projet-de-document"><i class="fa fa-check"></i><b>6.2</b> Intégration continue d’un projet de document</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chap-ci.html"><a href="chap-ci.html#sec:pat"><i class="fa fa-check"></i><b>6.2.1</b> Obtention d’un jeton d’accès personnel</a></li>
<li class="chapter" data-level="6.2.2" data-path="chap-ci.html"><a href="chap-ci.html#sec:activation-ci"><i class="fa fa-check"></i><b>6.2.2</b> Activation du dépôt sur Travis</a></li>
<li class="chapter" data-level="6.2.3" data-path="chap-ci.html"><a href="chap-ci.html#activation-du-dépôt-sur-codecov"><i class="fa fa-check"></i><b>6.2.3</b> Activation du dépôt sur CodeCov</a></li>
<li class="chapter" data-level="6.2.4" data-path="chap-ci.html"><a href="chap-ci.html#scripter-les-actions-de-travis"><i class="fa fa-check"></i><b>6.2.4</b> Scripter les actions de Travis</a></li>
<li class="chapter" data-level="6.2.5" data-path="chap-ci.html"><a href="chap-ci.html#ajouter-des-badges"><i class="fa fa-check"></i><b>6.2.5</b> Ajouter des badges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-shiny.html"><a href="chap-shiny.html"><i class="fa fa-check"></i><b>7</b> Shiny</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap-shiny.html"><a href="chap-shiny.html#première-application"><i class="fa fa-check"></i><b>7.1</b> Première application</a></li>
<li class="chapter" data-level="7.2" data-path="chap-shiny.html"><a href="chap-shiny.html#application-plus-élaborée"><i class="fa fa-check"></i><b>7.2</b> Application plus élaborée</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chap-shiny.html"><a href="chap-shiny.html#méthode-de-travail"><i class="fa fa-check"></i><b>7.2.1</b> Méthode de travail</a></li>
<li class="chapter" data-level="7.2.2" data-path="chap-shiny.html"><a href="chap-shiny.html#exemple"><i class="fa fa-check"></i><b>7.2.2</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chap-shiny.html"><a href="chap-shiny.html#sec:hebergement-shiny"><i class="fa fa-check"></i><b>7.3</b> Hébergement</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-enseigner.html"><a href="chap-enseigner.html"><i class="fa fa-check"></i><b>8</b> Enseigner avec R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chap-enseigner.html"><a href="chap-enseigner.html#learnr"><i class="fa fa-check"></i><b>8.1</b> learnr</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="chap-enseigner.html"><a href="chap-enseigner.html#premier-tutoriel"><i class="fa fa-check"></i><b>8.1.1</b> Premier tutoriel</a></li>
<li class="chapter" data-level="8.1.2" data-path="chap-enseigner.html"><a href="chap-enseigner.html#diffusion"><i class="fa fa-check"></i><b>8.1.2</b> Diffusion</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chap-enseigner.html"><a href="chap-enseigner.html#github-classrooms"><i class="fa fa-check"></i><b>8.2</b> GitHub Classrooms</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chap-enseigner.html"><a href="chap-enseigner.html#inscription"><i class="fa fa-check"></i><b>8.2.1</b> Inscription</a></li>
<li class="chapter" data-level="8.2.2" data-path="chap-enseigner.html"><a href="chap-enseigner.html#organisations"><i class="fa fa-check"></i><b>8.2.2</b> Organisations</a></li>
<li class="chapter" data-level="8.2.3" data-path="chap-enseigner.html"><a href="chap-enseigner.html#nouvelle-salle-de-classe"><i class="fa fa-check"></i><b>8.2.3</b> Nouvelle salle de classe</a></li>
<li class="chapter" data-level="8.2.4" data-path="chap-enseigner.html"><a href="chap-enseigner.html#préparer-un-modèle-de-dépôt"><i class="fa fa-check"></i><b>8.2.4</b> Préparer un modèle de dépôt</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-conclusion.html"><a href="chap-conclusion.html"><i class="fa fa-check"></i><b>9</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/EricMarcon/travailleR" target="blank">Hébergé sur GitHub, publié par bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Travailler avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap:ci" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Intégration continue</h1>
<p>L’intégration continue consiste à confier à un service externe la tâche de vérifier un package, produire des documents Markdown pour les pages web d’un dépôt GitHub ou tricoter entièrement un site web à partir du code.</p>
<p>Toutes ces tâches peuvent être accomplies localement sur le poste de travail mais prennent du temps et risquent de ne pas être répétées à chaque mise à jour.
Dans le cadre de l’intégration continue, elles le sont systématiquement, de façon transparente pour l’utilisateur.
En cas d’échec, un message d’alerte est envoyé.</p>
<p>La mise en place de l’intégration continue se justifie pour des projets lourds, avec des mises à jour régulières.
plutôt que pour des projets contenant un simple document Markdown rarement modifié.</p>
<div id="outils" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Outils</h2>
<div id="travis" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Travis</h3>
<p>L’outil utilisé le plus fréquemment pour des projets R déposés sur GitHub est <em>Travis CI</em><a href="#fn87" class="footnote-ref" id="fnref87"><sup>87</sup></a>.</p>
<p>Il est nécessaire d’ouvrir un compte sur le site.
Il est possible de s’authentifier avec son compte GitHub pour limiter le nombre de mots de passe.</p>
</div>
<div id="codecov" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Codecov</h3>
<p>Pour évaluer le taux de couverture du code des packages R, c’est-à-dire la proportion du code testé d’une façon ou d’une autre (exemples, tests unitaires, vignette), le service <em>Codecov</em><a href="#fn88" class="footnote-ref" id="fnref88"><sup>88</sup></a> s’intègre parfaitement à Travis.</p>
<p>Il faut là encore ouvrir un compte, de préférence en s’authentifiant par GitHub.</p>
</div>
<div id="github-pages" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> GitHub Pages</h3>
<p>Les pages web de GitHub peuvent être hébergées dans le répertoire <code>docs</code> de la branche master du projet: c’est la solution retenue quand elle sont produites sur le poste de travail.</p>
<p>Si elles sont produites par Travis, elle le seront obligatoirement dans une branche dédiée appelée <code>gh-pages</code>.</p>
</div>
</div>
<div id="intégration-continue-dun-projet-de-document" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Intégration continue d’un projet de document</h2>
<p>L’objectif est de faire tricoter par Travis un projet Markdown, comme ce document.
Cette pratique est appropriée pour les projets d’ouvrages, qui nécessitent beaucoup de ressources pour leur construction.
Dans ce type de projet, le code est tricoté par knitr pour produire plusieurs documents, typiquement aux formats HTML et PDF, accessibles sur les pages GitHub.
Quand les documents sont produits localement, ils sont placés dans le dossier <code>docs</code> et poussés sur GitHub.</p>
<p>Pour que Travis s’en charge, quelques réglages sont nécessaires.</p>
<div id="sec:pat" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Obtention d’un jeton d’accès personnel</h3>
<p>Pour écrire sur GitHub, le service d’intégration continue devra s’authentifier au moyen d’une clé privée, appelée <em>Personal Access Token</em> (PAT).</p>
<p>Les jetons sont créés sur GitHub, dans les paramètres de son compte d’utilisateur, dans *Developer Settings, Personal Access Tokens"<a href="#fn89" class="footnote-ref" id="fnref89"><sup>89</sup></a>.</p>
<p>Générer un nouveau jeton, le décrire en tant que “Travis” et lui donner l’autorisation “repo”, c’est-à-dire modifier <em>tous</em> les dépôts (il n’est pas possible de limiter l’accès à un dépôt particulier).
Le jeton est une chaîne de caractère qui ne pourra pas être relue plus tard: elle doit être sauvegardée comme un mot de passe.</p>
</div>
<div id="sec:activation-ci" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Activation du dépôt sur Travis</h3>
<p>Sur le site de Travis, afficher les paramètres de son compte d’utilisateur.
La liste des dépôts GitHub est présentée.
Pour en activer un, cliquer sur l’interrupteur gris à côté de son nom (figure <a href="chap-ci.html#fig:travis-Depots">6.1</a>).</p>

<p></p>
<div class="figure" style="text-align: center"><span id="fig:travis-Depots"></span>
<img src="images/travis-Depots.png" alt="Activation d’un dépôt dans Travis CI." width="80%" />
<p class="caption">
Figure 6.1: Activation d’un dépôt dans Travis CI.
</p>
</div>
<p></p>
<p>Cliquer ensuite sur “Settings” pour enregistrer le jeton d’accès.
Dans la zone <em>Environment variables</em>, compléter:</p>
<ul>
<li>Name : GITHUB_TOKEN</li>
<li>Value : &lt;coller le jeton&gt;</li>
</ul>
<p>Cliquer sur “Add”.
Le jeton ne pourra plus être lu sur Travis, pas plus que sur GitHub.
Il sera utilisé comme une variable, à partir de son nom, pour n’apparaître dans aucun fichier.</p>
<p>Le nom <em>GITHUB_TOKEN</em> est une convention: on pourrait le modifier, mais on ne le fait pas.</p>
</div>
<div id="activation-du-dépôt-sur-codecov" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Activation du dépôt sur CodeCov</h3>
<p>L’opération est similaire sur le site Codecov: l’analyse de la couverture du code des packages est utile pour détecter les portions de code non testées.
En revanche, l’analyse de la couverture des projets de document n’a pas d’intérêt.</p>
<p>Pour activer un dépôt, il faut d’authentifier sur le site de CodeCov avec son compte GitHub.
La liste des dépôts est affichée et peut être actualisée.
Si les dépôts à traiter sont hébergés par une organisation, par exemple les dépôts d’une salle de classe GitHub, il faut actualiser la liste des organisations en suivant les instructions (un lien permet de modifier rapidement les options de GithHub pour autoriser la lecture d’une organisation par Codecov) et à nouveau mettre à jour la liste des dépôts.
Enfin, quand le dépôt recherché est visible, il faut l’activer.
Il est inutile d’utiliser le système de jetons de Codecov pour les projets traités par Travis.</p>
</div>
<div id="scripter-les-actions-de-travis" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Scripter les actions de Travis</h3>
<div id="sec:bookdown-ci" class="section level4" number="6.2.4.1">
<h4><span class="header-section-number">6.2.4.1</span> Projet d’ouvrage</h4>
<p>Le script de contrôle de Travis doit être nommé <code>.travis.yml</code>.
Il est au format YAML.
Un script simple pour un projet <code>bookdown</code> ressemble à ceci (le signe <code>|&gt;</code> indique que la suite du code devrait se trouver sur la même ligne, mais est coupée pour le formatage de ce document):</p>
<pre><code>language: r

script:
- Rscript -e &quot;bookdown::render_book(&#39;index.Rmd&#39;, |&gt;
    &#39;bookdown::pdf_book&#39;, quiet = TRUE)&quot;
- Rscript -e &quot;bookdown::render_book(&#39;index.Rmd&#39;, |&gt;
    &#39;bookdown::gitbook&#39;, quiet = TRUE)&quot;

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  keep_history: true
  local_dir: docs
  on:
    branch: master</code></pre>
<p>Ce script minimal indique que le <em>langage</em> est R.</p>
<p>La partie <em>script</em> exécute des commandes sous R: <code>render_book</code> pour construire un livre, aux formats PDF et HTML.
Le fichier PDF doit exister pour que le lien vers son téléchargement soit affiché dans la barre de commandes du format HTML, qui doit donc être créé en dernier.</p>
<p>La partie <em>deploy</em> gère le déploiement du résultat, écrit dans le dossier <code>docs</code> de la branche <em>master</em> par <code>render_book</code>.
La commande <code>skip_cleanup</code> permet d’éviter que le contenu de <code>docs</code> soit effacé entre les phases <code>script</code> et <code>deploy</code>.
La version 2 de l’outil de déploiement de Travis CI supprimera cette commande.</p>
<p>Le fournisseur <code>pages</code> tire la branche <code>gh-pages</code> depuis GitHub, valide les modifications et pousse le résultat.
Le jeton GitHub est passé au script par Travis par la variable enregistrée précédemment, ce qui lui donne l’autorisation d’écrire sur GitHub.</p>
<p>Enfin, l’option <code>keep_history</code> permet de conserver l’historique de la branche <code>gh-pages</code>.
Elle peut être mise à <code>false</code> pour l’effacer (commande <code>git push --force</code>) puisque le contenu n’est que le résultat d’une production automatique, l’historique important étant celui du code.</p>
<p>Ce script peut être amélioré en ajoutant un cache:</p>
<ul>
<li>pour éviter à Travis de recompiler les packages R à chaque exécution, et économiser plusieurs minutes;</li>
<li>pour éviter à knitR d’évaluer les calculs de tous les bouts de codes non modifiés, qui peuvent nécessiter de longs calculs.</li>
</ul>
<p>Le code correspondant de la partie <code>cache</code>, à placer avant <code>script</code> est le suivant:</p>
<pre><code>cache:
  packages: true
  directories: _bookdown_files</code></pre>
<p>Enfin, Travis interrompt son exécution en absence de retour pendant 10 minutes.
Si des bouts de code exécutent des calculs longs, il faut augmenter cette limite avec la commande <code>travis_wait</code> qui reçoit comme premier argument le nombre de minutes permises, ici une heure:</p>
<pre><code>script:
  - travis_wait 60 Rscript -e |&gt;
      &quot;bookdown::render_book(&#39;index.Rmd&#39;, |&gt;
      &#39;bookdown::pdf_book&#39;, quiet = TRUE)&quot;
  - travis_wait 60 Rscript -e |&gt;
      &quot;bookdown::render_book(&#39;index.Rmd&#39;, |&gt;
      &#39;bookdown::gitbook&#39;, quiet = TRUE)&quot;</code></pre>
<p>Les packages R à installer depuis CRAN peuvent être déclarés avant le script par une entrée <code>r_packages</code> et une entrée <code>r_github_packages</code> pour les packages sur GitHub.
Ce n’est pas une bonne pratique pour les packages du projet: la bonne méthode consiste à utiliser un fichier <code>DESCRIPTION</code>, comme si le projet était un package R.
Les directives <code>Depends</code> et <code>Imports</code> de ce fichier <code>DESCRIPTION</code> sont prises en compte par Travis et installés.</p>
<p>Certains packages nécessitent pour leur installation sous Linux (à partir de leur code source) celle de packages <em>apt</em>.
Par exemple, le package R <em>sf</em> nécessite l’ajout des entrées suivantes:</p>
<pre><code>addons:
  apt:
    packages:
      - libudunits2-dev
      - libgdal-dev
      - libgeos-dev
      - libproj-dev</code></pre>
<p>Pour savoir quels packages <em>apt</em> installer, il est nécessaire de se référer à la documentation du package R et prendre en compte les instructions pour l’installation sous Ubuntu.</p>
<p>A la fin de l’exécution de son script, Travis peut envoyer systématiquement un message de compte-rendu:</p>
<pre><code>notifications:
  email:
    on_success: always</code></pre>
<p>Le comportement par défaut est d’envoyer un message au propriétaire du compte GitHub en cas d’échec ou seulement au premier succès d’un script qui échouait.</p>
<p>Finalement, les deux fichiers suivants sont ceux utilisés pour l’intégration continue de ce livre.</p>
<ul>
<li><p>Fichier <code>.travis.yml</code>:</p>
<p>language: r</p>
<p>cache:
packages: true
directories: _bookdown_files</p>
<p>script:
- travis_wait 60 Rscript -e |&gt;
“bookdown::render_book(‘index.Rmd’, |&gt;
‘bookdown::gitbook’, quiet = TRUE)”
- travis_wait 60 Rscript -e |&gt;
“bookdown::render_book(‘index.Rmd’, |&gt;
‘bookdown::pdf_book’, quiet = TRUE)”</p>
<p>deploy:
provider: pages
skip_cleanup: true
github_token: $GITHUB_TOKEN
keep_history: true
local_dir: docs
on:
branch: master</p></li>
<li><p>Fichier <code>DESCRIPTION</code>:</p>
<p>Package: travailleR
Title: Travailler avec R
Version: 1.0.0
<a href="mailto:Authors@R" class="email">Authors@R</a>: c(
person(“Eric”, “Marcon”, , “<a href="mailto:e.marcon@free.fr" class="email">e.marcon@free.fr</a>”, |&gt;
c(“aut”, “cre”))
)
URL: <a href="https://github.com/EricMarcon/travailleR" class="uri">https://github.com/EricMarcon/travailleR</a>
Depends:
R (&gt;= 3.1.0)
Imports:
bookdown,
kableExtra,
tidyverse,
magrittr,
gridExtra</p></li>
</ul>
</div>
<div id="sec:blogdown-ci" class="section level4" number="6.2.4.2">
<h4><span class="header-section-number">6.2.4.2</span> Site web blogdown</h4>
<p>Le fichier <code>.travis.yml</code> est très similaire:</p>
<pre><code>language: r
latex: false

branches:
  only:
    - master

cache:
  packages: yes
  directories:
    - $HOME/bin

script:
  - Rscript -e &#39;blogdown::install_hugo(force=TRUE)&#39;
  - Rscript -e &#39;blogdown::build_site(local = TRUE, |&gt;
      build_rmd = TRUE)&#39;
  - touch public/.nojekyll

deploy:
  provider: pages
  skip_cleanup: true
  token: $GITHUB_TOKEN
  on:
    branch: master
  local_dir: public
  repo: GitHubID/GitHubID.github.io
  target_branch: master</code></pre>
<p>L’instruction <code>latex: false</code> ajoutée en début de fichier permet d’économiser le temps de l’installation d’une distribution LaTeX puisqu’un site web n’en a normalement pas besoin.</p>
<p>La mise en cache de <code>$HOME/bin</code> évite d’installer à chaque fois le générateur de site web Hugo.</p>
<p>Le script consiste à installer Hugo avec le package <strong>blogdown</strong> puis à construire le site (la commande <code>build_site()</code> est similaire à la commande <code>serve_site()</code> utilisée pendant le développement mais ne lance pas de serveur web pour afficher le résultat).
Les arguments forcent la construction complète du site.</p>
<p>Le site est créé dans le dossier <code>public</code>.
La commande <code>touch</code> crée un fichier vide appelé <code>.nojekyll</code> qui servira après publication à indiquer à GitHub que le site web créé ne doit pas être traité par son propre générateur de sites appelé Jekyll.</p>
<p>Tout utilisateur de GitHub dispose d’un dépôt par défaut dont le nom est <code>GitHubID.github.io</code>.
Il n’a normalement qu’une seule branche <code>master</code>.
Le contenu de la branche est un site web (pas sa source, qui doit être placée dans un dépôt différent) accessible à l’adresse <a href="https://GitHubID.github.io" class="uri">https://GitHubID.github.io</a>.
Le déploiement copie le dossier <code>public</code> dans ce dépôt.
Il ne garde pas de trace de l’historique (<code>skip_cleanup: true</code>) puisque le contrôle de source est déjà activé dans le dépôt contenant le code source du site.</p>
<p>Un fichier <code>DESCRIPTION</code> est obligatoire pour Travis qui y cherche les packages R à installer.
Les premières lignes (Package, Title,…) ne sont pas utilisées par Travis mais permettent de respecter le format standard des fichiers <code>DESCRIPTION</code>.</p>
<pre><code>Package: Home-Page
Title: Eric Marcon&#39;s Home Page
Version: 1.0.0
Authors@R: c(
  person(&quot;Eric&quot;, &quot;Marcon&quot;, , &quot;e.marcon@free.fr&quot;, 
         c(&quot;aut&quot;, &quot;cre&quot;))
  )
URL: https://github.com/EricMarcon/Home-Page
Depends:
  R (&gt;= 3.1.0)
Imports:
  blogdown, 
  GoFKernel,
  igraph,
  scholar,
  tidyverse</code></pre>
<p>Tous les packages utilisés dans les fichiers R Markdown du site doivent être déclarés dans le fichier <code>DESCRIPTION</code>.</p>
<p>Si le site web utilise des données en ligne qui justifient de le mettre à jour périodiquement, Travis peut être lancé tous les jours, toutes les semaines ou tous les mois en plus des reconstruction déclenchées par une modification du dépôt sur GitHub.
Pour cela, afficher les propriétés du dépôt sur Travis-CI (voir la saisie du jeton GitHub en section <a href="chap-ci.html#sec:activation-ci">6.2.2</a>) et ajouter une tâche programmée (<em>cron job</em>).
Compléter puis cliquer sur “Add”:</p>
<ul>
<li>Branch: master;</li>
<li>Interval: selon les besoins;</li>
<li>Options: au choix, exécuter systématiquement ou ne pas le faire si le site a déjà été reconstruit dans les dernières 24 heures.</li>
</ul>
<p>Exemple: la page qui affiche la bibliométrie du site web<a href="#fn90" class="footnote-ref" id="fnref90"><sup>90</sup></a> de l’auteur interroge Google Scholar pour afficher les citations des publications.
Le site est mis à jour tous les mois pour que les statistiques soient à jour.</p>
</div>
<div id="sec:package-ci6" class="section level4" number="6.2.4.3">
<h4><span class="header-section-number">6.2.4.3</span> Packages R</h4>
<p>Le script minimal est:</p>
<pre><code>language: r</code></pre>
<p>Travis s’appuie sur le fichier <code>DESCRIPTION</code> pour installer les packages nécessaires et lance la vérification du package avec l’option <code>--as-cran</code>.
La vérification échoue si elle retourne une erreur, un avertissement ou une note.</p>
<p>Les packages supplémentaires, nécessaires aux actions de Travis en cas de succès, sont déclarés dans <code>r_packages</code>:</p>
<pre><code>r_packages: # Packages à installer pour Travis
  - covr    # Interfaçage de Covecov
  - pkgdown # Création du site d&#39;aide des packages R</code></pre>
<p>La partie <code>after_success</code> du script permet d’effectuer des tâches seulement dans cette situation: typiquement appeler Codecov pour mesurer le taux de couverture du code et utiliser <strong>pkgdown</strong> pour créer le site web d’aide:</p>
<pre><code>after_success:
  # Appel à Covecov
  - Rscript -e &#39;covr::codecov(type =&quot;all&quot;)&#39;
  # Dossier du site d&#39;aide
  - mkdir docs
  # Tirer...
  - git fetch origin gh-pages:gh-pages
  # ...dans docs
  - git --work-tree=docs checkout gh-pages -- .
  # Construction du site
  - travis_wait 60 Rscript -e &#39;pkgdown::build_site()&#39;
  # Fichier vide
  - touch docs/.nojekyll</code></pre>
<p>La construction du site par <strong>pkgdown</strong> est plus compliqué que celle d’un livre produit par <strong>bookdown</strong> parce que deux versions coexistent si le package est hébergé sur CRAN: à la racine du dossier <code>docs</code>, la version de production correspondant à la version sur CRAN et, dans <code>docs/dev</code>, la version correspondant à la version en cours du package.
Une seule est produite par Travis mais les deux doivent être conservées: il ne faut pas que la version de production, consultée par les utilisateurs du package, soit supprimée quand une version de développement est créée.</p>
<p>La dernière ligne du script consiste à créer un fichier vide nommé <code>.nojekyll</code> pour indiquer à GitHub que les pages web produites ne doivent pas être traitées comme le code source d’un site Jekyll, ce qui est le comportement par défaut des pages GitHub.</p>
<p>L’exemple suivant correspond au package <strong>entropart</strong>, déposé sur CRAN.</p>
<p>Fichier <code>.travis.yml</code>:</p>
<pre><code>language: r
warnings_are_errors: true     # Comportement de CRAN
cache: packages

r_packages:     # Packages à installer pour Travis
  - covr        # Interfaçage de Covecov
  - pkgdown     # Pour la création du site d&#39;aide

after_success:
  - Rscript -e &#39;covr::codecov(type =&quot;all&quot;)&#39; 
  - mkdir docs
  - git fetch origin gh-pages:gh-pages
  - git --work-tree=docs checkout gh-pages -- .
  - travis_wait 60 Rscript -e &#39;pkgdown::build_site()&#39;
  - touch docs/.nojekyll

deploy:
  provider: pages
  skip_cleanup: true
  keep_history: true                                   
  token: $GITHUB_TOKEN
  on:
    branch: master
  local_dir: docs

notifications:
  email:
    recipients:
      - e.marcon@free.fr</code></pre>
<p>Pour des paramétrages particuliers, la documentation complète de Travis peut être consultée<a href="#fn91" class="footnote-ref" id="fnref91"><sup>91</sup></a>.</p>
</div>
<div id="vérification-de-.travis.yml" class="section level4" number="6.2.4.4">
<h4><span class="header-section-number">6.2.4.4</span> Vérification de <code>.travis.yml</code></h4>
<p>Le débogage de la configuration de Travis est particulièrement laborieux parce que toute modification du fichier <code>.travis.yml</code> nécessite d’être validée et poussée pour déclencher Travis et éventuellement générer des erreurs.
L’ensemble du processus peut durer plusieurs dizaines de minutes.
Un outil de vérification en ligne<a href="#fn92" class="footnote-ref" id="fnref92"><sup>92</sup></a> permet de valider au moins la syntaxe du fichier et donc de gagner du temps.</p>
</div>
<div id="problèmes-transitoires" class="section level4" number="6.2.4.5">
<h4><span class="header-section-number">6.2.4.5</span> Problèmes transitoires</h4>
<p>Les changements de version de R, de LaTeX, de pandoc… peuvent générer des erreurs dans l’intégration continue.
Une bonne pratique consiste à adapter son fichier <code>.travis.yml</code> en s’inspirant de projets qui fonctionnent: il suffit de regarder leur code sur GitHub.</p>
<p>Parmi les problèmes les plus courants:</p>
<ul>
<li>pour les projets d’ouvrage, une version plus ancienne de pandoc sur Travis que sur le poste de travail empêche le bon tricot du document alors qu’il fonctionne parfaitement en local.
La solution consiste à forcer la version de pandoc (elle devra être mise à jour régulièrement).
Le début de fichier suivant force les versions de Linux et de pandoc:</li>
</ul>
<pre><code>language: r
os: linux
dist: xenial
pandoc_version: 2.7.3</code></pre>
<ul>
<li>pour tous les projets, la défaillance d’un package importé qui ne s’installe pas correctement peut être contournée en utilisant les versions binaires des packages fournies par RStudio.
Les commandes suivantes, ajoutées avant les scripts, permettent de le faire:</li>
</ul>
<pre><code># Packages binaires à partir de RStudio
before_install:
  - echo &quot;options(repos = 
     c(CRAN = &#39;https://packagemanager.rstudio.com/all/|&gt;
     __linux__/xenial/latest&#39;))&quot; &gt;&gt; ~/.Rprofile.site
  - echo &quot;options(HTTPUserAgent = paste0(&#39;R/&#39;,  |&gt;
    getRversion(), &#39; R (&#39;, paste(getRversion(), |&gt; 
    R.version[&#39;platform&#39;], R.version[&#39;arch&#39;],   |&gt; 
    R.version[&#39;os&#39;]), &#39;)&#39;))&quot; &gt;&gt; ~/.Rprofile.site</code></pre>
<p>Ces contournements devront être réévalués régulièrement et supprimés quand ils ne seront plus utiles.</p>
</div>
</div>
<div id="ajouter-des-badges" class="section level3" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Ajouter des badges</h3>
<p>Le succès du script sur Travis est visible sur GitHub en ajoutant un badge dans le fichier README.md, juste après le titre du fichier:</p>
<pre><code># Nom du projet

[![Travis-CI Build Status](https://travis-ci.org/ |&gt;
  &lt;GitHubID&gt;/&lt;Depot&gt;.svg?branch=master)] |&gt;
  (https://travis-ci.org/&lt;GitHubID&gt;/&lt;Depot&gt;)</code></pre>
<p>Le taux de couverture mesuré par Codecov peut aussi être affiché par un badge:</p>
<pre><code>![codecov](https://codecov.io/github/&lt;GitHubID&gt;/
  &lt;Depot&gt;/branch/master/graphs/badge.svg)]
  (https://codecov.io/github/&lt;GitHubID&gt;/&lt;Depot&gt;)</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="87">
<li id="fn87"><p><a href="https://travis-ci.org/" class="uri">https://travis-ci.org/</a><a href="chap-ci.html#fnref87" class="footnote-back">↩︎</a></p></li>
<li id="fn88"><p><a href="https://codecov.io/" class="uri">https://codecov.io/</a><a href="chap-ci.html#fnref88" class="footnote-back">↩︎</a></p></li>
<li id="fn89"><p><a href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line" class="uri">https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line</a><a href="chap-ci.html#fnref89" class="footnote-back">↩︎</a></p></li>
<li id="fn90"><p><a href="https://EricMarcon.github.io/fr/publication/" class="uri">https://EricMarcon.github.io/fr/publication/</a><a href="chap-ci.html#fnref90" class="footnote-back">↩︎</a></p></li>
<li id="fn91"><p><a href="https://docs.travis-ci.com/user/languages/r/" class="uri">https://docs.travis-ci.com/user/languages/r/</a><a href="chap-ci.html#fnref91" class="footnote-back">↩︎</a></p></li>
<li id="fn92"><p><a href="https://config.travis-ci.com/explore" class="uri">https://config.travis-ci.com/explore</a><a href="chap-ci.html#fnref92" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-shiny.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
